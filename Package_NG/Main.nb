(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     53587,       1430]
NotebookOptionsPosition[     51648,       1361]
NotebookOutlinePosition[     52084,       1378]
CellTagsIndexPosition[     52041,       1375]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
  "Get", "[", 
   "\"\<~/Nutstore/On Thinking/Non-Gaussianity/Programmes/Data \
Saved/Saved/resultOfExpansion.txt\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.598923235122494*^9, 3.598923243150334*^9}}],

Cell["Import packages:", "Text",
 CellChangeTimes->{{3.600053532669808*^9, 3.6000535850427933`*^9}, {
  3.600053618647753*^9, 3.6000536487351103`*^9}, {3.600053888710511*^9, 
  3.6000539048556347`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "path", " ", "=", " ", 
    "\"\<~/Nutstore/On Thinking/Git/Tools-For-QFT/Package_NG/\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
  "path", "<>", 
   "\"\<Basics/BasicAlgebraicOperations/OperationsOnVariables.m\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
  "path", "<>", 
   "\"\<Basics/BasicAlgebraicOperations/DivideLongSummation.m\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
  "path", "<>", 
   "\"\<Basics/BasicAlgebraicOperations/seperateMultipliedSubExprsAsList.m\>\"\
"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
  "path", "<>", "\"\<Basics/BasicAlgebraicOperations/ProtectSymbols.m\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
  "path", "<>", 
   "\"\<Basics/BasicAlgebraicOperations/DivideLongSummation.m\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
  "path", "<>", 
   "\"\<Basics/fourierTransformAdv/replaceByFourierExpansion_integrateAdv.m\>\
\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
  "path", "<>", 
   "\"\<Basics/fourierTransformAdv/basicRulesForIntegrateAdv.m\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"path", "<>", "\"\<Basics/actOn/ActOn.m\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.600053696513047*^9, 3.6000537278774977`*^9}, {
  3.600053778363441*^9, 3.60005389509787*^9}, {3.600053964326289*^9, 
  3.600054014016985*^9}, {3.600054085203785*^9, 3.600054092550064*^9}, {
  3.600054122629746*^9, 3.600054137552558*^9}, {3.600054329925596*^9, 
  3.600054339018207*^9}, {3.6000548269619226`*^9, 3.6000548459167852`*^9}, {
  3.600055620128151*^9, 3.60005564440641*^9}, {3.6000557451912107`*^9, 
  3.6000557513359118`*^9}, {3.600055949493291*^9, 3.6000559621276093`*^9}, {
  3.600074012081914*^9, 3.6000740128385153`*^9}, {3.600074245034397*^9, 
  3.600074246715968*^9}, {3.6000861833010283`*^9, 3.6000861836824617`*^9}, {
  3.600607987576501*^9, 3.600607989934952*^9}, {3.600608030816349*^9, 
  3.600608040880989*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"list3OrderPert", " ", "=", " ", 
    RowBox[{"divideLongSummationIntoList", "[", 
     RowBox[{"Expand", "@", "resultOfExpansion3Ord"}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.598923344269594*^9, 3.598923419642737*^9}, {
   3.598923564512904*^9, 3.598923568822148*^9}, 3.60002466524158*^9, {
   3.6000246992650347`*^9, 3.600024759400998*^9}, 3.600054789008325*^9, 
   3.6000548521290827`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5779119999999998`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.598923424874256*^9, 3.598923575390878*^9, {3.600024666610058*^9, 
   3.600024761637287*^9}, 3.600033648822824*^9, 3.6000337484948072`*^9, 
   3.600053928247383*^9, {3.6000543809654293`*^9, 3.6000543847572317`*^9}, {
   3.600054773237603*^9, 3.600054790703196*^9}, 3.600054853184161*^9, 
   3.600055272833006*^9, 3.600056091368005*^9, {3.600056382790843*^9, 
   3.600056386725809*^9}, 3.600074019377034*^9, 3.60007425060364*^9, 
   3.600086190836522*^9, 3.6000871158011217`*^9, 3.600087168720621*^9, 
   3.600168760485465*^9, 3.600605936057982*^9, 3.600608005501609*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", "list3OrderPert"}]], "Input",
 CellChangeTimes->{{3.598923380974182*^9, 3.598923393514661*^9}}],

Cell[BoxData["823"], "Output",
 CellChangeTimes->{
  3.598923394340452*^9, 3.598923602343278*^9, {3.600024672103228*^9, 
   3.60002472464559*^9}, 3.600024763764558*^9, 3.6000336497153597`*^9, 
   3.600033749106407*^9, 3.600053930125452*^9, 3.6000543865367603`*^9, {
   3.6000547746592083`*^9, 3.600054786142984*^9}, 3.600054855250434*^9, 
   3.600055273375864*^9, 3.600056092568512*^9, 3.600056386933263*^9, 
   3.600074020358491*^9, 3.6000742519108257`*^9, 3.600086191014955*^9, 
   3.6000871162107143`*^9, 3.600087169074499*^9, 3.600168761146603*^9, 
   3.600605936318491*^9, 3.600608008118451*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"list3OrderPert", "[", 
  RowBox[{"[", "100", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.598923607320929*^9, 3.598923609382869*^9}, {
   3.598925398349865*^9, 3.598925398899915*^9}, 3.598925491520244*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "6"}], " ", 
  RowBox[{"a", "[", "t", "]"}], " ", 
  SuperscriptBox[
   RowBox[{"\[ScriptCapitalR]", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "2"], " ", 
  RowBox[{
   SuperscriptBox["\[ScriptCapitalR]", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]], "Output",
 CellChangeTimes->{3.598923610535535*^9, 3.598925399650496*^9, 
  3.598925492153609*^9, 3.600024766080639*^9, 3.6000337501804523`*^9, 
  3.6000539312634163`*^9, 3.6000543896418333`*^9, 3.600054856440172*^9, 
  3.600055274425908*^9, 3.600056093571436*^9, 3.600056387621647*^9, 
  3.6000740211941853`*^9, 3.600074253495616*^9, 3.600086191657899*^9, 
  3.600087117023809*^9, 3.600087169085334*^9, 3.600168762278696*^9, 
  3.6006059376890497`*^9, 3.600608010281337*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"seperateMultipliedSubExprsAsList", "@", 
  RowBox[{"list3OrderPert", "[", 
   RowBox[{"[", "100", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6000319907130957`*^9, 3.6000319908613234`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "6", ",", 
   RowBox[{"a", "[", "t", "]"}], ",", 
   RowBox[{"\[ScriptCapitalR]", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
   RowBox[{"\[ScriptCapitalR]", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox["\[ScriptCapitalR]", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6000319691475477`*^9, 3.600031991550418*^9}, 
   3.60003211928815*^9, {3.600054877737241*^9, 3.600054883465164*^9}, 
   3.600055111349216*^9, 3.600055161132972*^9, 3.600055321495801*^9, 
   3.6000561285406*^9, 3.6000563883778887`*^9, 3.600074021966291*^9, 
   3.60007425433914*^9, 3.600086192317067*^9, 3.600087117719982*^9, 
   3.600087169093071*^9, 3.600168763257914*^9, 3.6006059387887173`*^9, 
   3.6006080111969337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tmp1", " ", "=", " ", 
   RowBox[{"replaceByFourierExpansion", "[", 
    RowBox[{
     RowBox[{"list3OrderPert", "[", 
      RowBox[{"[", "100", "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[ScriptCapitalR]", ",", " ", "\[Zeta]"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.599380702114154*^9, 3.599380707233367*^9}, {
  3.600032515726756*^9, 3.600032550183464*^9}, {3.600032617083061*^9, 
  3.60003265264555*^9}, {3.600033298961769*^9, 3.600033300670599*^9}, {
  3.600033786345975*^9, 3.60003378919928*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.001000000000000334`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "6", ",", 
     RowBox[{"a", "[", "t", "]"}], ",", 
     RowBox[{"integrateAdv", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1$673", " ", "x"}], "+", 
            RowBox[{"k2$674", " ", "y"}], "+", 
            RowBox[{"k3$675", " ", "z"}]}], ")"}]}]], " ", 
        RowBox[{"\[Zeta]", "[", 
         RowBox[{"k1$673", ",", "k2$674", ",", "k3$675", ",", "t"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1$673", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k2$674", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k3$675", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"integrateAdv", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1$677", " ", "x"}], "+", 
            RowBox[{"k2$678", " ", "y"}], "+", 
            RowBox[{"k3$679", " ", "z"}]}], ")"}]}]], " ", 
        RowBox[{"\[Zeta]", "[", 
         RowBox[{"k1$677", ",", "k2$678", ",", "k3$679", ",", "t"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1$677", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k2$678", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k3$679", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"integrateAdv", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k1$681", " ", "x"}], "+", 
             RowBox[{"k2$682", " ", "y"}], "+", 
             RowBox[{"k3$683", " ", "z"}]}], ")"}]}]]}], " ", 
        SuperscriptBox["k3$683", "2"], " ", 
        RowBox[{"\[Zeta]", "[", 
         RowBox[{"k1$681", ",", "k2$682", ",", "k3$683", ",", "t"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1$681", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k2$682", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k3$683", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.599380717940434*^9, 3.599380753716223*^9, 3.5993815068868313`*^9, 
   3.599381560554982*^9, 3.5993816292235107`*^9, {3.5993817429413233`*^9, 
   3.599381758638167*^9}, 3.6000253885672827`*^9, 3.600032567764677*^9, 
   3.600032618295789*^9, {3.600032659341955*^9, 3.600032676280511*^9}, 
   3.600033324142453*^9, 3.6000337528064823`*^9, {3.600033790716859*^9, 
   3.6000338104543953`*^9}, 3.600053936135879*^9, 3.600054407715557*^9, 
   3.600054871866599*^9, 3.6000553091293707`*^9, 3.600056128246443*^9, 
   3.600056406027542*^9, 3.600074039579524*^9, 3.600074271959837*^9, 
   3.600086209693281*^9, 3.600087186013934*^9, 3.600168781141082*^9, 
   3.600608012597453*^9, 3.6006080458196087`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tmp2", " ", "=", " ", 
   RowBox[{"tmp1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Zeta]", "[", 
       RowBox[{"k1_", ",", " ", "k2_", ",", " ", "k3_", ",", " ", "t_"}], 
       "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "t"}], "]"}],
         " ", 
        RowBox[{"aOpt", "[", 
         RowBox[{"k1", ",", " ", "k2", ",", " ", "k3"}], "]"}]}], " ", "+", 
       " ", 
       RowBox[{
        RowBox[{"uStar", "[", 
         RowBox[{
          RowBox[{"-", "k1"}], ",", " ", 
          RowBox[{"-", "k2"}], ",", " ", 
          RowBox[{"-", "k3"}], ",", " ", "t"}], "]"}], " ", 
        RowBox[{"dagger", "@", 
         RowBox[{"aOpt", "[", 
          RowBox[{
           RowBox[{"-", "k1"}], ",", " ", 
           RowBox[{"-", "k2"}], ",", " ", 
           RowBox[{"-", "k3"}]}], "]"}]}]}]}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6000331573136187`*^9, 3.600033224940123*^9}, {
   3.600033273881982*^9, 3.600033275026444*^9}, {3.600033328978978*^9, 
   3.600033333247913*^9}, {3.6000334653671722`*^9, 3.6000334914641447`*^9}, 
   3.600033798432767*^9, {3.600059435299376*^9, 3.600059449965365*^9}, {
   3.600168610915785*^9, 3.6001686152184973`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "6", ",", 
     RowBox[{"a", "[", "t", "]"}], ",", 
     RowBox[{"integrateAdv", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1$673", " ", "x"}], "+", 
            RowBox[{"k2$674", " ", "y"}], "+", 
            RowBox[{"k3$675", " ", "z"}]}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"aOpt", "[", 
            RowBox[{"k1$673", ",", "k2$674", ",", "k3$675"}], "]"}], " ", 
           RowBox[{"u", "[", 
            RowBox[{"k1$673", ",", "k2$674", ",", "k3$675", ",", "t"}], 
            "]"}]}], "+", 
          RowBox[{
           RowBox[{"dagger", "[", 
            RowBox[{"aOpt", "[", 
             RowBox[{
              RowBox[{"-", "k1$673"}], ",", 
              RowBox[{"-", "k2$674"}], ",", 
              RowBox[{"-", "k3$675"}]}], "]"}], "]"}], " ", 
           RowBox[{"uStar", "[", 
            RowBox[{
             RowBox[{"-", "k1$673"}], ",", 
             RowBox[{"-", "k2$674"}], ",", 
             RowBox[{"-", "k3$675"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1$673", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k2$674", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k3$675", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"integrateAdv", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k1$677", " ", "x"}], "+", 
            RowBox[{"k2$678", " ", "y"}], "+", 
            RowBox[{"k3$679", " ", "z"}]}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"aOpt", "[", 
            RowBox[{"k1$677", ",", "k2$678", ",", "k3$679"}], "]"}], " ", 
           RowBox[{"u", "[", 
            RowBox[{"k1$677", ",", "k2$678", ",", "k3$679", ",", "t"}], 
            "]"}]}], "+", 
          RowBox[{
           RowBox[{"dagger", "[", 
            RowBox[{"aOpt", "[", 
             RowBox[{
              RowBox[{"-", "k1$677"}], ",", 
              RowBox[{"-", "k2$678"}], ",", 
              RowBox[{"-", "k3$679"}]}], "]"}], "]"}], " ", 
           RowBox[{"uStar", "[", 
            RowBox[{
             RowBox[{"-", "k1$677"}], ",", 
             RowBox[{"-", "k2$678"}], ",", 
             RowBox[{"-", "k3$679"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1$677", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k2$678", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k3$679", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"integrateAdv", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k1$681", " ", "x"}], "+", 
             RowBox[{"k2$682", " ", "y"}], "+", 
             RowBox[{"k3$683", " ", "z"}]}], ")"}]}]]}], " ", 
        SuperscriptBox["k3$683", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"aOpt", "[", 
            RowBox[{"k1$681", ",", "k2$682", ",", "k3$683"}], "]"}], " ", 
           RowBox[{"u", "[", 
            RowBox[{"k1$681", ",", "k2$682", ",", "k3$683", ",", "t"}], 
            "]"}]}], "+", 
          RowBox[{
           RowBox[{"dagger", "[", 
            RowBox[{"aOpt", "[", 
             RowBox[{
              RowBox[{"-", "k1$681"}], ",", 
              RowBox[{"-", "k2$682"}], ",", 
              RowBox[{"-", "k3$683"}]}], "]"}], "]"}], " ", 
           RowBox[{"uStar", "[", 
            RowBox[{
             RowBox[{"-", "k1$681"}], ",", 
             RowBox[{"-", "k2$682"}], ",", 
             RowBox[{"-", "k3$683"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1$681", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k2$682", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k3$683", ",", 
           RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.600033351509981*^9, {3.6000334897494717`*^9, 3.600033505961185*^9}, 
   3.600033824108235*^9, 3.6000553553851357`*^9, 3.600056142145977*^9, 
   3.600056432393086*^9, 3.600059464576013*^9, 3.6000740536507883`*^9, 
   3.600074298660276*^9, 3.600086223638891*^9, 3.600087212750009*^9, 
   3.6001688078120527`*^9, 3.600608054122326*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"FundamentalQNumbers", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"aOpt", ",", " ", "boson"}], "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.600055580897431*^9, 3.600055587921741*^9}, {
  3.600168604027626*^9, 3.60016860446101*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp2", "[", 
  RowBox[{"[", "4", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600033565756887*^9, 3.600033574287528*^9}, {
   3.600033861701139*^9, 3.600033861812088*^9}, {3.600056272793098*^9, 
   3.6000562855588493`*^9}, 3.6000563964682627`*^9}],

Cell[BoxData[
 RowBox[{"integrateAdv", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"k1$673", " ", "x"}], "+", 
        RowBox[{"k2$674", " ", "y"}], "+", 
        RowBox[{"k3$675", " ", "z"}]}], ")"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"aOpt", "[", 
        RowBox[{"k1$673", ",", "k2$674", ",", "k3$675"}], "]"}], " ", 
       RowBox[{"u", "[", 
        RowBox[{"k1$673", ",", "k2$674", ",", "k3$675", ",", "t"}], "]"}]}], 
      "+", 
      RowBox[{
       RowBox[{"dagger", "[", 
        RowBox[{"aOpt", "[", 
         RowBox[{
          RowBox[{"-", "k1$673"}], ",", 
          RowBox[{"-", "k2$674"}], ",", 
          RowBox[{"-", "k3$675"}]}], "]"}], "]"}], " ", 
       RowBox[{"uStar", "[", 
        RowBox[{
         RowBox[{"-", "k1$673"}], ",", 
         RowBox[{"-", "k2$674"}], ",", 
         RowBox[{"-", "k3$675"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1$673", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2$674", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k3$675", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.6000335514769907`*^9, {3.600033845902218*^9, 3.600033862365028*^9}, 
   3.600055590775731*^9, 3.600056142428217*^9, {3.6000562759806833`*^9, 
   3.600056282527198*^9}, 3.600056432655411*^9, 3.600059465212509*^9, 
   3.600074054191697*^9, 3.6000742992266693`*^9, 3.600078442195245*^9, 
   3.6000793667729387`*^9, 3.600081923291873*^9, 3.600086223872491*^9, 
   3.600087213064992*^9, 3.6001688085640583`*^9, 3.600608059697714*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tmpResult1", " ", "=", " ", 
   RowBox[{"actOn", "[", 
    RowBox[{
     RowBox[{"tmp2", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
     RowBox[{"ket", "[", 
      RowBox[{"{", "}"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.600033455452799*^9, 3.600033457759438*^9}, {
  3.6000334978768787`*^9, 3.600033532155735*^9}, {3.600033866960339*^9, 
  3.600033867107024*^9}, {3.6000741530550423`*^9, 3.6000741729832277`*^9}, {
  3.6000743711151657`*^9, 3.600074375772025*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.008998999999999757`", ",", 
   RowBox[{"integrateAdv", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1$673", " ", "x"}], "+", 
          RowBox[{"k2$674", " ", "y"}], "+", 
          RowBox[{"k3$675", " ", "z"}]}], ")"}]}]], " ", 
      RowBox[{"ket", "[", 
       RowBox[{"{", 
        RowBox[{"aOpt", "[", 
         RowBox[{
          RowBox[{"-", "k1$673"}], ",", 
          RowBox[{"-", "k2$674"}], ",", 
          RowBox[{"-", "k3$675"}]}], "]"}], "}"}], "]"}], " ", 
      RowBox[{"uStar", "[", 
       RowBox[{
        RowBox[{"-", "k1$673"}], ",", 
        RowBox[{"-", "k2$674"}], ",", 
        RowBox[{"-", "k3$675"}], ",", "t"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k1$673", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k2$674", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k3$675", ",", 
         RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6000743591402483`*^9, 3.600074391482883*^9, 3.600075740930588*^9, {
   3.600078453054494*^9, 3.600078465038164*^9}, 3.600079368032033*^9, 
   3.600081924376185*^9, 3.6000827438806677`*^9, 3.6000862361953297`*^9, 
   3.600087217323876*^9, 3.600088444214555*^9, 3.600166798527768*^9, 
   3.600168813055937*^9, 3.60060806119242*^9}]
}, Open  ]],

Cell["Wonderful!!!", "Text",
 CellChangeTimes->{{3.600086255274441*^9, 3.600086258551519*^9}, {
  3.600087124911972*^9, 3.600087126325622*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp3", " ", "=", " ", 
  RowBox[{"Times", "@@", "tmp2"}]}]], "Input",
 CellChangeTimes->{{3.6000868726691713`*^9, 3.600086897270254*^9}, {
  3.600086943270782*^9, 3.6000869562638397`*^9}, {3.600087072893229*^9, 
  3.600087080506319*^9}, {3.600087143374434*^9, 3.6000871462509527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "6"}], " ", 
  RowBox[{"a", "[", "t", "]"}], " ", 
  RowBox[{"integrateAdv", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1$673", " ", "x"}], "+", 
         RowBox[{"k2$674", " ", "y"}], "+", 
         RowBox[{"k3$675", " ", "z"}]}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"aOpt", "[", 
         RowBox[{"k1$673", ",", "k2$674", ",", "k3$675"}], "]"}], " ", 
        RowBox[{"u", "[", 
         RowBox[{"k1$673", ",", "k2$674", ",", "k3$675", ",", "t"}], "]"}]}], 
       "+", 
       RowBox[{
        RowBox[{"dagger", "[", 
         RowBox[{"aOpt", "[", 
          RowBox[{
           RowBox[{"-", "k1$673"}], ",", 
           RowBox[{"-", "k2$674"}], ",", 
           RowBox[{"-", "k3$675"}]}], "]"}], "]"}], " ", 
        RowBox[{"uStar", "[", 
         RowBox[{
          RowBox[{"-", "k1$673"}], ",", 
          RowBox[{"-", "k2$674"}], ",", 
          RowBox[{"-", "k3$675"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1$673", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k2$674", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k3$675", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
    ",", 
    RowBox[{"{", "}"}]}], "]"}], " ", 
  RowBox[{"integrateAdv", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1$677", " ", "x"}], "+", 
         RowBox[{"k2$678", " ", "y"}], "+", 
         RowBox[{"k3$679", " ", "z"}]}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"aOpt", "[", 
         RowBox[{"k1$677", ",", "k2$678", ",", "k3$679"}], "]"}], " ", 
        RowBox[{"u", "[", 
         RowBox[{"k1$677", ",", "k2$678", ",", "k3$679", ",", "t"}], "]"}]}], 
       "+", 
       RowBox[{
        RowBox[{"dagger", "[", 
         RowBox[{"aOpt", "[", 
          RowBox[{
           RowBox[{"-", "k1$677"}], ",", 
           RowBox[{"-", "k2$678"}], ",", 
           RowBox[{"-", "k3$679"}]}], "]"}], "]"}], " ", 
        RowBox[{"uStar", "[", 
         RowBox[{
          RowBox[{"-", "k1$677"}], ",", 
          RowBox[{"-", "k2$678"}], ",", 
          RowBox[{"-", "k3$679"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1$677", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k2$678", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k3$679", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
    ",", 
    RowBox[{"{", "}"}]}], "]"}], " ", 
  RowBox[{"integrateAdv", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k1$681", " ", "x"}], "+", 
          RowBox[{"k2$682", " ", "y"}], "+", 
          RowBox[{"k3$683", " ", "z"}]}], ")"}]}]]}], " ", 
     SuperscriptBox["k3$683", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"aOpt", "[", 
         RowBox[{"k1$681", ",", "k2$682", ",", "k3$683"}], "]"}], " ", 
        RowBox[{"u", "[", 
         RowBox[{"k1$681", ",", "k2$682", ",", "k3$683", ",", "t"}], "]"}]}], 
       "+", 
       RowBox[{
        RowBox[{"dagger", "[", 
         RowBox[{"aOpt", "[", 
          RowBox[{
           RowBox[{"-", "k1$681"}], ",", 
           RowBox[{"-", "k2$682"}], ",", 
           RowBox[{"-", "k3$683"}]}], "]"}], "]"}], " ", 
        RowBox[{"uStar", "[", 
         RowBox[{
          RowBox[{"-", "k1$681"}], ",", 
          RowBox[{"-", "k2$682"}], ",", 
          RowBox[{"-", "k3$683"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1$681", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k2$682", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k3$683", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
    ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.600086900848394*^9, 3.600086956847393*^9}, 
   3.6000870764692*^9, 3.600087217636598*^9, 3.6000884516699944`*^9, 
   3.600166807177462*^9, 3.600168813434185*^9, 3.600608074863921*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp31", " ", "=", " ", 
  RowBox[{"Times", "[", 
   RowBox[{
    RowBox[{"a", "[", "t", "]"}], ",", " ", 
    RowBox[{"tmp2", "[", 
     RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
    RowBox[{"tmp2", "[", 
     RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.600167029080411*^9, 3.600167075568467*^9}, 
   3.600167253734137*^9, {3.6001680102737207`*^9, 3.600168020460587*^9}, {
   3.6001684838963757`*^9, 3.6001684958829603`*^9}, {3.600168790009714*^9, 
   3.6001687905842037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "[", "t", "]"}], " ", 
  RowBox[{"integrateAdv", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1$673", " ", "x"}], "+", 
         RowBox[{"k2$674", " ", "y"}], "+", 
         RowBox[{"k3$675", " ", "z"}]}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"aOpt", "[", 
         RowBox[{"k1$673", ",", "k2$674", ",", "k3$675"}], "]"}], " ", 
        RowBox[{"u", "[", 
         RowBox[{"k1$673", ",", "k2$674", ",", "k3$675", ",", "t"}], "]"}]}], 
       "+", 
       RowBox[{
        RowBox[{"dagger", "[", 
         RowBox[{"aOpt", "[", 
          RowBox[{
           RowBox[{"-", "k1$673"}], ",", 
           RowBox[{"-", "k2$674"}], ",", 
           RowBox[{"-", "k3$675"}]}], "]"}], "]"}], " ", 
        RowBox[{"uStar", "[", 
         RowBox[{
          RowBox[{"-", "k1$673"}], ",", 
          RowBox[{"-", "k2$674"}], ",", 
          RowBox[{"-", "k3$675"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1$673", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k2$674", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k3$675", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
    ",", 
    RowBox[{"{", "}"}]}], "]"}], " ", 
  RowBox[{"integrateAdv", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1$677", " ", "x"}], "+", 
         RowBox[{"k2$678", " ", "y"}], "+", 
         RowBox[{"k3$679", " ", "z"}]}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"aOpt", "[", 
         RowBox[{"k1$677", ",", "k2$678", ",", "k3$679"}], "]"}], " ", 
        RowBox[{"u", "[", 
         RowBox[{"k1$677", ",", "k2$678", ",", "k3$679", ",", "t"}], "]"}]}], 
       "+", 
       RowBox[{
        RowBox[{"dagger", "[", 
         RowBox[{"aOpt", "[", 
          RowBox[{
           RowBox[{"-", "k1$677"}], ",", 
           RowBox[{"-", "k2$678"}], ",", 
           RowBox[{"-", "k3$679"}]}], "]"}], "]"}], " ", 
        RowBox[{"uStar", "[", 
         RowBox[{
          RowBox[{"-", "k1$677"}], ",", 
          RowBox[{"-", "k2$678"}], ",", 
          RowBox[{"-", "k3$679"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1$677", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k2$678", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k3$679", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
    ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Output",
 CellChangeTimes->{3.600608078647025*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"actOn", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1$2784", " ", "x"}], "+", 
           RowBox[{"k2$2785", " ", "y"}], "+", 
           RowBox[{"k3$2786", " ", "z"}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"aOpt", "[", 
           RowBox[{"k1$2784", ",", "k2$2785", ",", "k3$2786"}], "]"}], " ", 
          RowBox[{"u", "[", 
           RowBox[{"k1$2784", ",", "k2$2785", ",", "k3$2786", ",", "t"}], 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{"dagger", "[", 
           RowBox[{"aOpt", "[", 
            RowBox[{
             RowBox[{"-", "k1$2784"}], ",", 
             RowBox[{"-", "k2$2785"}], ",", 
             RowBox[{"-", "k3$2786"}]}], "]"}], "]"}], " ", 
          RowBox[{"uStar", "[", 
           RowBox[{
            RowBox[{"-", "k1$2784"}], ",", 
            RowBox[{"-", "k2$2785"}], ",", 
            RowBox[{"-", "k3$2786"}], ",", "t"}], "]"}]}]}], ")"}]}], ")"}], 
     "*", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1$618", " ", "x"}], "+", 
           RowBox[{"k2$619", " ", "y"}], "+", 
           RowBox[{"k3$620", " ", "z"}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"aOpt", "[", 
           RowBox[{"k1$618", ",", "k2$619", ",", "k3$620"}], "]"}], " ", 
          RowBox[{"u", "[", 
           RowBox[{"k1$618", ",", "k2$619", ",", "k3$620", ",", "t"}], 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{"dagger", "[", 
           RowBox[{"aOpt", "[", 
            RowBox[{
             RowBox[{"-", "k1$618"}], ",", 
             RowBox[{"-", "k2$619"}], ",", 
             RowBox[{"-", "k3$620"}]}], "]"}], "]"}], " ", 
          RowBox[{"uStar", "[", 
           RowBox[{
            RowBox[{"-", "k1$618"}], ",", 
            RowBox[{"-", "k2$619"}], ",", 
            RowBox[{"-", "k3$620"}], ",", "t"}], "]"}]}]}], ")"}]}], ")"}]}], 
    ",", " ", 
    RowBox[{"ket", "[", 
     RowBox[{"{", "}"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600168885573167*^9, 3.600168935897492*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.015997999999999735`", ",", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1$2784", " ", "x"}], "+", 
         RowBox[{"k2$2785", " ", "y"}], "+", 
         RowBox[{"k3$2786", " ", "z"}]}], ")"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"k1$618", " ", "x"}], "+", 
         RowBox[{"k2$619", " ", "y"}], "+", 
         RowBox[{"k3$620", " ", "z"}]}], ")"}]}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"DiracDelta", "[", 
        RowBox[{"k1$2784", "+", "k1$618"}], "]"}], " ", 
       RowBox[{"DiracDelta", "[", 
        RowBox[{"k2$2785", "+", "k2$619"}], "]"}], " ", 
       RowBox[{"DiracDelta", "[", 
        RowBox[{"k3$2786", "+", "k3$620"}], "]"}], " ", 
       RowBox[{"ket", "[", 
        RowBox[{"{", "}"}], "]"}], " ", 
       RowBox[{"u", "[", 
        RowBox[{"k1$2784", ",", "k2$2785", ",", "k3$2786", ",", "t"}], "]"}], 
       " ", 
       RowBox[{"uStar", "[", 
        RowBox[{
         RowBox[{"-", "k1$618"}], ",", 
         RowBox[{"-", "k2$619"}], ",", 
         RowBox[{"-", "k3$620"}], ",", "t"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"ket", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"aOpt", "[", 
           RowBox[{
            RowBox[{"-", "k1$618"}], ",", 
            RowBox[{"-", "k2$619"}], ",", 
            RowBox[{"-", "k3$620"}]}], "]"}], ",", 
          RowBox[{"aOpt", "[", 
           RowBox[{
            RowBox[{"-", "k1$2784"}], ",", 
            RowBox[{"-", "k2$2785"}], ",", 
            RowBox[{"-", "k3$2786"}]}], "]"}]}], "}"}], "]"}], " ", 
       RowBox[{"uStar", "[", 
        RowBox[{
         RowBox[{"-", "k1$2784"}], ",", 
         RowBox[{"-", "k2$2785"}], ",", 
         RowBox[{"-", "k3$2786"}], ",", "t"}], "]"}], " ", 
       RowBox[{"uStar", "[", 
        RowBox[{
         RowBox[{"-", "k1$618"}], ",", 
         RowBox[{"-", "k2$619"}], ",", 
         RowBox[{"-", "k3$620"}], ",", "t"}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.600168952056937*^9, 3.600608094020624*^9}]
}, Open  ]],

Cell[TextData[StyleBox["You see, if get rid of the integrals, or if not \
evaluate the integrals, the programme is quite quite wonderful, otherwise, \
because of the horrible but useless evaluation of those integrals, this \
progamme becomes useless!!!\n\nSo, all the reason making the programme slow \
or even become useless is that Mathematica always keeps evaluating the \
integrals within the procedure, which is useless and useless until the end of \
the whole procedure!!!",
 FontSlant->"Italic",
 FontColor->RGBColor[0, 1, 0]]], "Text",
 CellChangeTimes->{{3.600169019483992*^9, 3.600169353047598*^9}, {
  3.600621856235561*^9, 3.600621857939665*^9}}],

Cell["\<\
Then, by not loading the definition of integrateAdv[], things becomes quite \
wonderful!!:\
\>", "Text",
 CellChangeTimes->{{3.600608120151175*^9, 3.60060816830525*^9}, {
   3.600621843040827*^9, 3.600621848496085*^9}, {3.600621887766168*^9, 
   3.600621941494069*^9}, 3.600621995589457*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tmp4", " ", "=", " ", 
   RowBox[{"actOn", "[", 
    RowBox[{
     RowBox[{"Times", "@@", "tmp2"}], ",", " ", 
     RowBox[{"ket", "[", 
      RowBox[{"{", "}"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6001668117214518`*^9, 3.600166838256961*^9}, 
   3.6001670842451982`*^9, {3.600621727858885*^9, 3.600621750422072*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0559910000000059`", ",", 
   RowBox[{
    RowBox[{"-", "6"}], " ", 
    RowBox[{"a", "[", "t", "]"}], " ", 
    RowBox[{"integrateAdv", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1$673", " ", "x"}], "+", 
           RowBox[{"k2$674", " ", "y"}], "+", 
           RowBox[{"k3$675", " ", "z"}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"integrateAdv", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k1$677", " ", "x"}], "+", 
                 RowBox[{"k2$678", " ", "y"}], "+", 
                 RowBox[{"k3$679", " ", "z"}]}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"integrateAdv", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k1$681", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k2$682", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k3$683", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], 
                    "}"}]}], "}"}], ",", 
                  RowBox[{"{", "}"}]}], "]"}], " ", 
                RowBox[{"u", "[", 
                 RowBox[{"k1$677", ",", "k2$678", ",", "k3$679", ",", "t"}], 
                 "]"}]}], "+", 
               RowBox[{
                RowBox[{"integrateAdv", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k1$681", " ", "x"}], "+", 
                    RowBox[{"k2$682", " ", "y"}], "+", 
                    RowBox[{"k3$683", " ", "z"}]}], ")"}]}]]}], " ", 
                   SuperscriptBox["k3$683", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DiracDelta", "[", 
                    RowBox[{"k1$673", "+", "k1$681"}], "]"}], " ", 
                    RowBox[{"DiracDelta", "[", 
                    RowBox[{"k2$674", "+", "k2$682"}], "]"}], " ", 
                    RowBox[{"DiracDelta", "[", 
                    RowBox[{"k3$675", "+", "k3$683"}], "]"}], " ", 
                    RowBox[{"ket", "[", 
                    RowBox[{"{", 
                    RowBox[{"aOpt", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$677"}], ",", 
                    RowBox[{"-", "k2$678"}], ",", 
                    RowBox[{"-", "k3$679"}]}], "]"}], "}"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"DiracDelta", "[", 
                    RowBox[{"k1$673", "+", "k1$677"}], "]"}], " ", 
                    RowBox[{"DiracDelta", "[", 
                    RowBox[{"k2$674", "+", "k2$678"}], "]"}], " ", 
                    RowBox[{"DiracDelta", "[", 
                    RowBox[{"k3$675", "+", "k3$679"}], "]"}], " ", 
                    RowBox[{"ket", "[", 
                    RowBox[{"{", 
                    RowBox[{"aOpt", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$681"}], ",", 
                    RowBox[{"-", "k2$682"}], ",", 
                    RowBox[{"-", "k3$683"}]}], "]"}], "}"}], "]"}]}]}], ")"}],
                    " ", 
                   RowBox[{"uStar", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$681"}], ",", 
                    RowBox[{"-", "k2$682"}], ",", 
                    RowBox[{"-", "k3$683"}], ",", "t"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k1$681", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k2$682", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k3$683", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], 
                    "}"}]}], "}"}], ",", 
                  RowBox[{"{", "}"}]}], "]"}], " ", 
                RowBox[{"uStar", "[", 
                 RowBox[{
                  RowBox[{"-", "k1$677"}], ",", 
                  RowBox[{"-", "k2$678"}], ",", 
                  RowBox[{"-", "k3$679"}], ",", "t"}], "]"}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k1$677", ",", 
                RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k2$678", ",", 
                RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k3$679", ",", 
                RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
             "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], " ", 
          RowBox[{"u", "[", 
           RowBox[{"k1$673", ",", "k2$674", ",", "k3$675", ",", "t"}], 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{"integrateAdv", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k1$677", " ", "x"}], "+", 
                 RowBox[{"k2$678", " ", "y"}], "+", 
                 RowBox[{"k3$679", " ", "z"}]}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"integrateAdv", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k1$681", " ", "x"}], "+", 
                    RowBox[{"k2$682", " ", "y"}], "+", 
                    RowBox[{"k3$683", " ", "z"}]}], ")"}]}]]}], " ", 
                   SuperscriptBox["k3$683", "2"], " ", 
                   RowBox[{"DiracDelta", "[", 
                    RowBox[{"k1$677", "+", "k1$681"}], "]"}], " ", 
                   RowBox[{"DiracDelta", "[", 
                    RowBox[{"k2$678", "+", "k2$682"}], "]"}], " ", 
                   RowBox[{"DiracDelta", "[", 
                    RowBox[{"k3$679", "+", "k3$683"}], "]"}], " ", 
                   RowBox[{"ket", "[", 
                    RowBox[{"{", 
                    RowBox[{"aOpt", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$673"}], ",", 
                    RowBox[{"-", "k2$674"}], ",", 
                    RowBox[{"-", "k3$675"}]}], "]"}], "}"}], "]"}], " ", 
                   RowBox[{"uStar", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$681"}], ",", 
                    RowBox[{"-", "k2$682"}], ",", 
                    RowBox[{"-", "k3$683"}], ",", "t"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k1$681", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k2$682", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k3$683", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], 
                    "}"}]}], "}"}], ",", 
                  RowBox[{"{", "}"}]}], "]"}], " ", 
                RowBox[{"u", "[", 
                 RowBox[{"k1$677", ",", "k2$678", ",", "k3$679", ",", "t"}], 
                 "]"}]}], "+", 
               RowBox[{
                RowBox[{"integrateAdv", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"k1$681", " ", "x"}], "+", 
                    RowBox[{"k2$682", " ", "y"}], "+", 
                    RowBox[{"k3$683", " ", "z"}]}], ")"}]}]]}], " ", 
                   SuperscriptBox["k3$683", "2"], " ", 
                   RowBox[{"ket", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"aOpt", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$681"}], ",", 
                    RowBox[{"-", "k2$682"}], ",", 
                    RowBox[{"-", "k3$683"}]}], "]"}], ",", 
                    RowBox[{"aOpt", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$677"}], ",", 
                    RowBox[{"-", "k2$678"}], ",", 
                    RowBox[{"-", "k3$679"}]}], "]"}], ",", 
                    RowBox[{"aOpt", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$673"}], ",", 
                    RowBox[{"-", "k2$674"}], ",", 
                    RowBox[{"-", "k3$675"}]}], "]"}]}], "}"}], "]"}], " ", 
                   RowBox[{"uStar", "[", 
                    RowBox[{
                    RowBox[{"-", "k1$681"}], ",", 
                    RowBox[{"-", "k2$682"}], ",", 
                    RowBox[{"-", "k3$683"}], ",", "t"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k1$681", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k2$682", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"k3$683", ",", 
                    RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], 
                    "}"}]}], "}"}], ",", 
                  RowBox[{"{", "}"}]}], "]"}], " ", 
                RowBox[{"uStar", "[", 
                 RowBox[{
                  RowBox[{"-", "k1$677"}], ",", 
                  RowBox[{"-", "k2$678"}], ",", 
                  RowBox[{"-", "k3$679"}], ",", "t"}], "]"}]}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k1$677", ",", 
                RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k2$678", ",", 
                RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k3$679", ",", 
                RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
             "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], " ", 
          RowBox[{"uStar", "[", 
           RowBox[{
            RowBox[{"-", "k1$673"}], ",", 
            RowBox[{"-", "k2$674"}], ",", 
            RowBox[{"-", "k3$675"}], ",", "t"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k1$673", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k2$674", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k3$675", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], "}"}], 
      ",", 
      RowBox[{"{", "}"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6001669939408607`*^9, 3.600167223238448*^9, 3.6001673970034723`*^9, 
   3.600168161798369*^9, 3.60016843681456*^9, 3.600168944936461*^9, 
   3.600620702087142*^9, {3.600621728616848*^9, 3.600621751753372*^9}}]
}, Open  ]]
},
WindowSize->{1280, 774},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 244, 6, 36, "Input"],
Cell[804, 28, 202, 3, 35, "Text"],
Cell[1009, 33, 2154, 53, 244, "Input"],
Cell[CellGroupData[{
Cell[3188, 90, 473, 10, 36, "Input"],
Cell[3664, 102, 688, 11, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4389, 118, 133, 2, 36, "Input"],
Cell[4525, 122, 600, 9, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5162, 136, 230, 4, 36, "Input"],
Cell[5395, 142, 941, 21, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6373, 168, 217, 4, 36, "Input"],
Cell[6593, 174, 1042, 23, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7672, 202, 591, 13, 36, "Input"],
Cell[8266, 217, 3909, 97, 154, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12212, 319, 1341, 33, 129, "Input"],
Cell[13556, 354, 5485, 143, 242, "Output"]
}, Open  ]],
Cell[19056, 500, 296, 7, 36, "Input"],
Cell[CellGroupData[{
Cell[19377, 511, 272, 5, 36, "Input"],
Cell[19652, 518, 1919, 50, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21608, 573, 547, 12, 36, "Input"],
Cell[22158, 587, 1661, 43, 96, "Output"]
}, Open  ]],
Cell[23834, 633, 143, 2, 35, "Text"],
Cell[CellGroupData[{
Cell[24002, 639, 309, 5, 36, "Input"],
Cell[24314, 646, 4845, 137, 242, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29196, 788, 533, 12, 36, "Input"],
Cell[29732, 802, 3092, 89, 167, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32861, 896, 2418, 67, 225, "Input"],
Cell[35282, 965, 2231, 62, 137, "Output"]
}, Open  ]],
Cell[37528, 1030, 658, 10, 126, "Text"],
Cell[38189, 1042, 301, 6, 36, "Text"],
Cell[CellGroupData[{
Cell[38515, 1052, 389, 9, 36, "Input"],
Cell[38907, 1063, 12725, 295, 502, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
